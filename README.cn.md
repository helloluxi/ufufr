# Lu Timer（三盲训练器）

[![en](https://img.shields.io/badge/lang-English-blue.svg)](README.md)
[![简体中文](https://img.shields.io/badge/lang-简体中文-red.svg)](README.cn.md)

一款专为三盲设计的网页训练工具，采用自适应练习方法，针对薄弱环节进行重点训练，提升学习效率。

本项目更像是一个代码库而非成品。我鼓励你阅读代码，理解其背后的原理，并根据自己的训练需求构建适合自己的版本。

## 核心理念

**简而言之：** 模拟比赛 ≠ 高效训练，薄弱case需要更多练习机会。

在比赛中，打乱是完全随机的——每个case出现的概率相等（当然根据 cycle break 策略会略有差异）。但这种随机性对于训练来说效率并不高。假设你已经熟练掌握了 818 种case中的 800 种（秒记、零失误），但还有 18 种特定case始终不够熟练（记忆慢或偶尔出错），那么随机打乱就会让你把大量时间浪费在反复练习已经掌握的case上。当然，偶尔用完全随机的打乱来保持手感仍然是有必要的。

**核心思想：** 自适应频率训练效率更高。不熟练的case应该比已掌握的case更高频率地出现。本工具实现了这个理念——你可以标记不熟练的case，它们会在后续训练中自动提高出现频率。这个理念借鉴了打字练习网站 [keybr.com](https://www.keybr.com/)，以及运动员、音乐家、医生普遍使用的刻意练习原则。

## 工作原理

训练算法采用加权采样系统：

- **练习过的case**：`times^(-2/(1 + mark × falloff))`
- **新case**：你设定的学习率

权重函数更像是一个经验公式而非严格测试结果，你可以根据自己的学习习惯随意调整。

## 快速开始

### 安装

1. **Fork 本仓库** - 强烈推荐，可以自由地做版本控制、数据管理 (也欢迎开源社区做出大众化的改进！)
2. 将你 fork 的仓库克隆到本地，可以选择本地使用 / 部署到 Github Pages / 部署到自己的服务器（搭配你喜欢的数据同步方案！）

### 个性化配置（强烈推荐）

正式使用前，建议先根据你的还原习惯进行配置：

#### 1. 编码方案与缓冲块 ([cube3.js](cube3.js))

修改编码方案和缓冲块位置，使其符合你的个人系统：

```javascript 
// cube3.js 第 7-25 行

// UF FU UL LU UB BU UR RU
// DF FD DL LD DB BD DR RD
// FR RF FL LF BL LB BR RB
static edgeLetterScheme = 'ABCDEFGHIJKLMNOPQRSTWXYZ';

// UFR RUF FUR UFL FUL LUF
// UBL LUB BUL UBR BUR RUB
// DFL LDF FDL DBL BDL LDB
// DBR BRD RDB DFR FDR RDF
static cornLetterScheme = 'ahqcbtedwgfzilsknxmpyojr';

// 0: UF, 1: UL, 2: UB, 3: UR
// 4: DF, 5: DL, 6: DB, 7: DR
// 8: FR, 9: FL, 10: BL, 11: BR
static edgeBufferIdx = 0;

// 0: UFR, 1: UFL, 2: UBL, 3: UBR
// 4: DFL, 5: DBL, 6: DBR, 7: DFR
static cornBufferIdx = 0;
```

如果你喜欢用大写字母表示角块，别忘了交换 `isEdge` 和 `isCorner` 函数。

#### 2. 颜色配置 ([ufufr.js](ufufr.js))

自定义魔方配色方案：

```javascript
// ufufr.js 第 20-27 行
this.colorMapping = {
    'd': '#FFFFFF', // 白色 (下)
    'u': '#FFFF00', // 黄色 (上)
    'f': '#FF0000', // 红色 (前)
    'b': '#FFA500', // 橙色 (后)
    'l': '#0000FF', // 蓝色 (左)
    'r': '#00FF00'  // 绿色 (右)
};
```

#### 3. 记忆编码 ([mem.txt](mem.txt))

填入你为每个字母对设定的记忆词或记忆图像。

#### 4. 公式库 ([alg.txt](alg.txt))

添加每种case的还原公式。

## 使用指南

### 计时器使用

- **启动计时器**：长按魔方显示区域直到变绿
- **停止计时器**：计时过程中轻触魔方显示区域即可停止
- 生成新打乱时计时器会自动重置

### 标记系统

标记某个case时（点击对应按钮）：
- 按钮外观会改变（高亮显示，鼠标悬停时显示标记次数）
- 该case在后续训练中出现频率提高
- 权重增加：标记次数越多 = 出现概率越高
- 统计数据自动保存至浏览器 localStorage

**注意事项**：以下case暂不支持标记：
- **浮动三循环**：由浮动缓冲块冲突生成的case
- **奇偶**：有小循环和翻色时的奇偶
- **随机模式**

### 命令行界面

工具内置了用于高级操作的命令行。打开方式：
- 双击魔方显示区域
- 或直接开始输入（会自动打开）

| 命令 | 说明 | 示例 |
|---------|-------------|---------|
| `.KEY` | 查询特定case的信息 | `.CG` 显示 CG 的记忆编码、公式和统计数据 |
| `+KEY1 KEY2 ...` | 手动标记case | `+CG c+g+` 标记 CG 和 c+g+ |
| `-KEY1 KEY2 ...` | 移除标记并重置 | `-CG` 将 CG 重置为未标记状态 |
| `c` | 复制时间、打乱、时间戳到剪贴板 | `c` |
| `d MODE` | 切换训练模式 | `d e` 切换到纯棱训练模式 |
| `t` | 显示标记次数最多的前 7 个case | `t` |
| `u` | 重新加载 service worker | `u` |

按 `Enter` 执行命令，按 `↑` 键可调用上一条命令。

训练模式：
- `r`: 随机模式
- `e`: 纯棱训练
- `c`: 纯角训练
- `ec`: 棱角分控（棱块+角块均自适应）
- `rc`: 棱随角控（棱块随机+角块自适应）

### 设置面板

双击标题栏或按反引号键（`）打开设置：

- **模式**：选择训练模式（随机、纯棱、纯角等）
- **奇偶**：是否包含奇偶case
- **学习率**：控制新case的出现概率
- **衰减率**：标记的重要性随练习次数衰减的速度（越高 = 已标记case衰减越慢）
- **翻转/扭转**：纯翻转/扭转case的出现概率（0-1）
- **三扭转**：三个角块扭转case的出现概率（0-1）
- **浮动**：浮动缓冲块case的出现概率（0-1）

### 快捷键

- `Tab`：生成下一个打乱
- `1`-`9`：标记/取消标记对应按钮（从左到右）
- `↑`：在命令行中调用上一条命令
- `Enter`：在命令行中执行命令
- `Esc`：关闭命令行或设置面板

### 数据存储

所有数据存储在浏览器 localStorage 中：
- **已看教程**：是否已查看教程（`bld.seenTutorial`）
- **统计数据**：每种case的练习次数和标记次数（`bld.stats`）
- **个人设置**：用户偏好配置（`bld.settings`）
- **静态文件**：`alg.txt` 和 `mem.txt` 从服务器加载

本工具无任何数据上传，你的数据完全属于你自己。

## 设计理念：打造属于你的工具

**本工具体现的是一种训练理念，而非万能的标准答案。** 我强烈建议你理解这些原则后，开发一个更适合自己的版本。

每位盲拧选手都有独特的习惯：不同的编码方案、不同的记忆系统、不同的薄弱环节、不同的高阶技巧（如 LTCT）。最有效的训练工具，永远是为自己量身定制的那一个。

## 维护与支持

由于本人已不是活跃选手，此仓库**不会持续维护**。这只是一个出于教育目的分享的个人训练工具。

- **公开演示的 Bug 修复**：会修
- **功能需求**：不接受，请 fork 后自行实现
- **打赏**：如果你在 WCA 比赛遇见我，请我喝杯咖啡 :)

我个人使用的是部署在私人服务器上的定制版本，公开版本并未经过充分测试。
使用本项目的最佳姿势是 fork 一份，自己做版本控制和数据管理。

## 致谢

- **陈霜**：感谢提供优秀的 [`min2phase.js`](https://github.com/cs0x7f/min2phase.js) 库，本工具的魔方求解功能完全依赖于此。
- **NCSU Cubepack**：感谢鼓励我在退役 6 年后于 2025 年 3 月比赛一次。

## 开源许可

版权所有 (C) 2025-2026 Xi Lu

本项目采用 **GNU 通用公共许可证 v3.0 (GPLv3)**。

简单来说：
- ✅ 可以自由使用、修改和分发
- ✅ 可以用于商业用途
- ⚠️ 如果你发布修改版本，必须：
  - 同样使用 GPLv3 许可
  - 公开源代码
  - 说明修改内容
- ⚠️ 软件按"原样"提供，不附带任何保证

完整许可条款见 [LICENSE](LICENSE) 文件。

---

**盲拧快乐！**

Xi Lu (2018LUXI01)
